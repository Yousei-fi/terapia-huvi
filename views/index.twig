{% extends "base.twig" %}

{% block content %}
{% set lang = language ?? 'fi' %}

{% set hero_defaults = {
  'fi': {
    'eyebrow': 'Ratkaisukeskeinen lyhytterapia',
    'title': 'Rauhallista muutosta – yksi keskustelu kerrallaan',
    'cta_primary_label': 'Varaa aika',
    'cta_primary_url': '#',
    'cta_secondary_label': 'Lue lisää terapiasta',
    'cta_secondary_url': '/terapia'
  },
  'en': {
    'eyebrow': 'Solution-focused brief therapy',
    'title': 'Peaceful change – one conversation at a time',
    'cta_primary_label': 'Book a session',
    'cta_primary_url': '#',
    'cta_secondary_label': 'Learn about therapy',
    'cta_secondary_url': '/terapia?lang=en'
  }
} %}
{% set hero_body_defaults = {
  'fi': '<p>Ratkaisukeskeinen lyhytterapia auttaa sinua löytämään toivoa, voimavaroja ja suuntaa elämään silloin, kun asiat tuntuvat jumittuneilta. Yhdessä tutkimme, mikä jo toimii elämässäsi ja miten voimme rakentaa siitä eteenpäin.</p>',
  'en': '<p>Solution-focused brief therapy helps you find hope, resources, and direction in life when things feel stuck. Together we explore what already works in your life and how we can build on that.</p>'
} %}
{% set hero_default = hero_defaults[lang] ?? hero_defaults.fi %}
{% set hero_body_default = hero_body_defaults[lang] ?? hero_body_defaults.fi %}

<section id="hero" class="relative overflow-hidden text-brand-white">
  <div class="absolute inset-0 bg-hero-pattern opacity-40"></div>
  <div class="absolute inset-0 bg-accent-glow opacity-40"></div>
  <div class="relative mx-auto max-w-6xl px-4 py-16 md:py-20">
    <div class="max-w-3xl space-y-6">
      <span class="eyebrow text-white/70">{{ page_field('frontpage-hero', 'eyebrow_' ~ lang, hero_default.eyebrow) }}</span>
      <h2 class="text-4xl font-semibold tracking-tight md:text-5xl">{{ page_field('frontpage-hero', 'title_' ~ lang, hero_default.title) }}</h2>
      <div class="prose prose-invert max-w-none text-base text-white/80 md:text-lg">
        {{ page_field('frontpage-hero', 'content_' ~ lang, hero_body_default)|raw }}
      </div>
      <div class="flex flex-wrap items-center gap-3">
        <a href="{{ page_field('frontpage-hero', 'cta_primary_url_' ~ lang, hero_default.cta_primary_url) }}" class="btn-primary">{{ page_field('frontpage-hero', 'cta_primary_label_' ~ lang, hero_default.cta_primary_label) }}</a>
        <a href="{{ page_field('frontpage-hero', 'cta_secondary_url_' ~ lang, hero_default.cta_secondary_url) }}" class="btn-secondary">{{ page_field('frontpage-hero', 'cta_secondary_label_' ~ lang, hero_default.cta_secondary_label) }}</a>
      </div>
    </div>
  </div>
</section>

{% set blog_defaults = {
  'fi': {
    'eyebrow': 'Blogi',
    'title': 'Blogi ja ajatuksia',
    'copy': '<p>Lue ajatuksiani terapiasta, hyvinvoinnista ja elämän haasteista.</p>',
    'cta_label': 'Kaikki artikkelit',
    'cta_url': '/blogi',
    'empty': 'Artikkeleita on tulossa pian – seuraa minua somessa pysyäksesi ajan tasalla.'
  },
  'en': {
    'eyebrow': 'Blog',
    'title': 'Blog and thoughts',
    'copy': '<p>Read my thoughts on therapy, wellbeing, and life challenges.</p>',
    'cta_label': 'All articles',
    'cta_url': '/blogi?lang=en',
    'empty': 'Articles coming soon—follow me on social media to stay in the loop.'
  }
} %}
{% set blog_default = blog_defaults[lang] ?? blog_defaults.fi %}

<section id="blogi" class="py-16 text-brand-white md:py-20">
  <div class="mx-auto max-w-6xl px-4">
    <div class="md:flex md:items-end md:justify-between">
      <div class="md:max-w-xl">
        <span class="eyebrow text-white/80">{{ page_field('frontpage-blog', 'eyebrow_' ~ lang, blog_default.eyebrow) }}</span>
        <h2 class="section-heading text-white">{{ page_field('frontpage-blog', 'title_' ~ lang, blog_default.title) }}</h2>
        <div class="prose prose-invert max-w-none text-sm text-white/80">
          {{ page_field('frontpage-blog', 'content_' ~ lang, blog_default.copy)|raw }}
        </div>
      </div>
      <a href="{{ page_field('frontpage-blog', 'cta_url_' ~ lang, blog_default.cta_url) }}" class="btn-secondary mt-6 md:mt-0">{{ page_field('frontpage-blog', 'cta_label_' ~ lang, blog_default.cta_label) }}</a>
    </div>
    {% if posts %}
      <div class="mt-12 grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {% for post in posts %}
          {{ include('card.twig', {
            title: post.title,
            link: post.link,
            meta: post.date(lang == 'fi' ? 'j.n.Y' : 'F j, Y'),
            content: post.excerpt ? post.excerpt : post.content|striptags|slice(0, 150) ~ '...',
            image: post.thumbnail ? post.thumbnail.src('large') : null,
          }) }}
        {% endfor %}
      </div>
    {% else %}
      <p class="mt-10 text-base text-white/70">{{ page_field('frontpage-blog', 'empty_message_' ~ lang, blog_default.empty) }}</p>
    {% endif %}
  </div>
</section>

{% set overview_defaults = {
  'fi': {
    'eyebrow': 'Palvelut',
    'title': 'Miten voin auttaa',
    'cards': [
      { 'title': 'Terapia', 'copy': 'Ratkaisukeskeinen lyhytterapia auttaa sinua löytämään toivoa ja suuntaa elämään.', 'cta_label': 'Lue lisää', 'cta_url': '/terapia' },
      { 'title': 'Hinnasto', 'copy': 'Selkeät hinnat eri palveluille. Varaa aika vastaanotolleni.', 'cta_label': 'Katso hinnasto', 'cta_url': '/hinnasto' },
      { 'title': 'Lahjakortit', 'copy': 'Anna terapeuttinen lahjakortti läheisellesi.', 'cta_label': 'Lue lisää', 'cta_url': '/lahjakortit' }
    ]
  },
  'en': {
    'eyebrow': 'Services',
    'title': 'How I can help',
    'cards': [
      { 'title': 'Therapy', 'copy': 'Solution-focused brief therapy helps you find hope and direction in life.', 'cta_label': 'Learn more', 'cta_url': '/terapia?lang=en' },
      { 'title': 'Pricing', 'copy': 'Clear pricing for different services. Book an appointment at my office.', 'cta_label': 'View pricing', 'cta_url': '/hinnasto?lang=en' },
      { 'title': 'Gift cards', 'copy': 'Give a therapeutic gift card to someone close to you.', 'cta_label': 'Learn more', 'cta_url': '/lahjakortit?lang=en' }
    ]
  }
} %}
{% set overview_default = overview_defaults[lang] ?? overview_defaults.fi %}
{% set overview_cards = page_field_cards('frontpage-overview', 'cards_' ~ lang, overview_default.cards) %}

<section id="overview" class="py-16 md:py-20">
  <div class="mx-auto max-w-6xl px-4">
    <span class="eyebrow text-white/80">{{ page_field('frontpage-overview', 'eyebrow_' ~ lang, overview_default.eyebrow) }}</span>
    <h2 class="section-heading text-white">{{ page_field('frontpage-overview', 'title_' ~ lang, overview_default.title) }}</h2>
    <div class="mt-12 grid gap-8 md:grid-cols-3">
      {% for card in overview_cards %}
        <article class="flex h-full flex-col rounded-3xl border border-white/20 bg-white/10 p-6 backdrop-blur shadow-soft transition duration-150 hover:-translate-y-1 hover:border-white/30">
          <h3 class="text-lg font-semibold text-white">{{ card.title }}</h3>
          <p class="mt-3 text-sm text-white/80">{{ card.copy }}</p>
          <div class="mt-auto pt-6">
            <a href="{{ card.cta_url }}" class="inline-flex items-center gap-2 text-sm font-semibold text-white transition hover:text-white/80">
              <span>{{ card.cta_label }}</span>
              <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M5 12h14" />
                <path d="M13 6l6 6-6 6" />
              </svg>
            </a>
          </div>
        </article>
      {% endfor %}
    </div>
  </div>
</section>

{% set contact_defaults = {
  'fi': {
    'eyebrow': 'Yhteystiedot',
    'title': 'Ota yhteyttä',
    'copy': 'Ota rohkeasti yhteyttä, jos haluat keskustella terapiasta tai varata ajan.',
    'general_label': 'Sähköposti:',
    'phone_label': 'Puhelin:',
    'address_label': 'Osoite:',
    'social_heading': 'Seuraa minua'
  },
  'en': {
    'eyebrow': 'Contact',
    'title': 'Get in touch',
    'copy': 'Feel free to reach out if you want to discuss therapy or book an appointment.',
    'general_label': 'Email:',
    'phone_label': 'Phone:',
    'address_label': 'Address:',
    'social_heading': 'Follow me'
  }
} %}
{% set contact_default = contact_defaults[lang] ?? contact_defaults.fi %}
{% set contact_email = page_field('frontpage-contact', 'general_contact_email_' ~ lang, 'terapia@terapiahuvi.fi') %}
{% set contact_phone = page_field('frontpage-contact', 'contact_phone_' ~ lang, '+358 44 999 2092') %}
{% set contact_address = page_field('frontpage-contact', 'contact_address_' ~ lang, lang == 'fi' ? 'Aleksanterinkatu 29 B 18, 33100 Tampere' : 'Aleksanterinkatu 29 B 18, 33100 Tampere, Finland') %}

<section id="yhteystiedot" class="py-16 text-brand-white md:py-20">
  <div class="mx-auto max-w-4xl px-4">
    <div class="text-center">
      <span class="eyebrow text-white/80">{{ page_field('frontpage-contact', 'eyebrow_' ~ lang, contact_default.eyebrow) }}</span>
      <h2 class="section-heading text-white mt-2">{{ page_field('frontpage-contact', 'title_' ~ lang, contact_default.title) }}</h2>
      <p class="section-copy text-white/80 mt-3">{{ page_field('frontpage-contact', 'copy_' ~ lang, contact_default.copy) }}</p>
    </div>
    <div class="mt-10 grid gap-6 md:grid-cols-2">
      <div class="rounded-3xl border border-white/20 bg-white/10 p-6 backdrop-blur">
        <h3 class="text-sm font-semibold uppercase tracking-wide text-white/70 mb-4">{{ page_field('frontpage-contact', 'general_contact_label_' ~ lang, contact_default.general_label) }}</h3>
        <p class="text-lg text-white"><a href="mailto:{{ contact_email }}" class="underline decoration-white/40 decoration-2 underline-offset-4 hover:text-white">{{ contact_email }}</a></p>
      </div>
      <div class="rounded-3xl border border-white/20 bg-white/10 p-6 backdrop-blur">
        <h3 class="text-sm font-semibold uppercase tracking-wide text-white/70 mb-4">{{ page_field('frontpage-contact', 'phone_label_' ~ lang, contact_default.phone_label) }}</h3>
        <p class="text-lg text-white"><a href="tel:+358449992092" class="underline decoration-white/40 decoration-2 underline-offset-4 hover:text-white">{{ contact_phone }}</a></p>
      </div>
    </div>
    <div class="mt-6 rounded-3xl border border-white/20 bg-white/10 p-6 backdrop-blur text-center">
      <h3 class="text-sm font-semibold uppercase tracking-wide text-white/70 mb-2">{{ page_field('frontpage-contact', 'address_label_' ~ lang, contact_default.address_label) }}</h3>
      <p class="text-white">{{ contact_address }}</p>
    </div>
    <div class="mt-8 text-center">
      <a href="#" class="btn-secondary">Varaa aika vastaanotolleni</a>
    </div>
  </div>
</section>

{% set testimonials_defaults = {
  'fi': {
    'eyebrow': 'Asiakkaiden palaute',
    'title': 'Mitä asiakkaat sanovat',
    'testimonials': [
      { 'name': 'Karel T.', 'rating': 5, 'text': 'Olen ollut Valtterin asiakkaana Tampereella säännöllisesti jo vuosia. Asiakkaan tarpeet kartoitetaan perinpohjaisesti ja tekemisestä välittyy rautainen ammattitaito. Ilmapiiri on rento ja hyvää läppää lentää! Suosittelen ehdottomasti Valtterin palveluita myös muille, hän on taitava terapeutti!' },
      { 'name': 'Lauri S.', 'rating': 5, 'text': 'Olen pitkään harrastanut erinäistä kuntoilua ja urheilua. Harrastus on kuitenkin aina ollut omapäistä touhua. Hakeuduin Valtterille, kun havahduin selkävaivoihin - varasin hieronnan, mutta sain kokonaisvaltaisen katsauksen ja läpikäynnin. Oli hienoa saada selkeää ohjausta ja yksinkertaisesti hyvin toimivia kehonhuoltoon ja treenaamiseen liittyviä vinkkejä. Kohtaaminen oli kokonaisvaltainen ja erittäin motivoiva!' },
      { 'name': 'Maria P.', 'rating': 5, 'text': 'Ammattitaitoinen ja asiantunteva terapeutti. Löytää ongelmakohdat ja auttaa löytämään ratkaisuja, sekä antaa vinkkejä, miten näitä haasteita pystyy itse jatkossa lievittämään. Rento, mutta asiallinen palvelu.' }
    ]
  },
  'en': {
    'eyebrow': 'Client feedback',
    'title': 'What clients say',
    'testimonials': [
      { 'name': 'Karel T.', 'rating': 5, 'text': 'I have been Valtteri\'s client in Tampere regularly for years. Client needs are thoroughly mapped out and the work shows solid professional expertise. The atmosphere is relaxed and there\'s good banter! I absolutely recommend Valtteri\'s services to others, he is a skilled therapist!' },
      { 'name': 'Lauri S.', 'rating': 5, 'text': 'I have long been involved in various fitness and sports activities. However, it has always been a bit of a solo effort. I came to Valtteri when I noticed back problems - I booked a massage, but got a comprehensive review and walkthrough. It was great to get clear guidance and simply very effective tips for body care and training. The encounter was comprehensive and very motivating!' },
      { 'name': 'Maria P.', 'rating': 5, 'text': 'Professional and knowledgeable therapist. Finds problem areas and helps find solutions, and gives tips on how to alleviate these challenges yourself in the future. Relaxed but professional service.' }
    ]
  }
} %}
{% set testimonials_data = testimonials_defaults[lang] ?? testimonials_defaults.fi %}
{% set testimonials_raw = page_field('frontpage-testimonials', 'testimonials_' ~ lang, '') %}
{% set testimonials = [] %}
{% if testimonials_raw %}
  {% for line in testimonials_raw|split('\n') %}
    {% if line|trim %}
      {% set parts = line|split('::') %}
      {% if parts|length >= 3 %}
        {% set testimonials = testimonials|merge([{
          'name': parts[0]|trim,
          'rating': parts[1]|trim|number_format(0)|replace({',': ''}),
          'text': parts[2]|trim
        }]) %}
      {% endif %}
    {% endif %}
  {% endfor %}
{% endif %}
{% if testimonials is empty %}
  {% set testimonials = testimonials_data.testimonials %}
{% endif %}

<section id="testimonials" class="py-16 md:py-20">
  <div class="mx-auto max-w-6xl px-4">
    <div class="text-center">
      <span class="eyebrow text-white/80">{{ page_field('frontpage-testimonials', 'eyebrow_' ~ lang, testimonials_data.eyebrow) }}</span>
      <h2 class="section-heading text-white mt-2">{{ page_field('frontpage-testimonials', 'title_' ~ lang, testimonials_data.title) }}</h2>
    </div>
    <div class="mt-12 grid gap-8 md:grid-cols-3">
      {% for testimonial in testimonials %}
        <article class="flex h-full flex-col rounded-3xl border border-white/20 bg-white/10 p-6 backdrop-blur">
          <div class="mb-4 flex items-center gap-1">
            {% set rating = testimonial.rating|default(5)|number_format(0)|replace({',': ''})|number_format(0) %}
            {% for i in 1..5 %}
              <svg class="h-5 w-5 {% if i <= rating %}text-yellow-400{% else %}text-white/20{% endif %}" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
              </svg>
            {% endfor %}
          </div>
          <p class="flex-1 text-sm text-white/90 leading-relaxed">{{ testimonial.text|default(testimonial.copy) }}</p>
          <p class="mt-4 text-sm font-semibold text-white">{{ testimonial.name|default(testimonial.title) }}</p>
        </article>
      {% endfor %}
    </div>
  </div>
</section>
{% endblock %}

